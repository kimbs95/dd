<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
   <mapper namespace="com.dd.dealing.dao.DealingDAO">
   
	<resultMap id="dealResult" type="dealingVO">
		<result property="dl_Num" column="dl_Num" />
		<result property="dl_Title" column="dl_Title" />
		<result property="user_Id" column="user_Id" />
		<result property="dl_City" column="dl_City" />
		<result property="dl_Address" column="dl_Address" />
		<result property="dl_Option" column="dl_Option" />
		<result property="dl_Form" column="dl_Form" />
		<result property="dl_Form2" column="dl_Form2" />
		<result property="dl_Room" column="dl_Room" />
		<result property="dl_Size" column="dl_Size" />
		<result property="dl_Content" column="dl_Content" />
		<result property="dl_Price" column="dl_Price" />
		<result property="dl_Image" column="dl_Image" />
		<result property="dl_Lat" column="dl_Lat" />
		<result property="dl_Lng" column="dl_Lng" />
 		
	</resultMap> 
	<resultMap  id="imgResult" type="dealingVO">
		<result property="dl_Image" column="dl_Image" />
		<result property="dl_Num" column="dl_Image" />
	</resultMap>
	
	<!-- 매물등록 --> 
	  <insert id="addNewdealing"  parameterType="java.util.Map">
		<![CDATA[
		 insert into dealing_t(dl_Num,dl_Title,user_Id,dl_City,dl_Address,dl_Option,dl_Form,dl_Form2,dl_Room,dl_Size,dl_Content,dl_Price,dl_Image, dl_Lat, dl_Lng)
		 values(#{dl_Num},#{dl_Title},#{user_Id},#{dl_City},#{dl_Address},#{dl_Option},#{dl_Form},#{dl_Form2},#{dl_Room},#{dl_Size},#{dl_Content},#{dl_Price},#{dl_Image}, #{dl_Lat}, #{dl_Lng})
		]]>
	</insert>
	
	<insert id="insertNewImage" parameterType="java.util.Map">
		INSERT INTO dealing_t(dl_Image,dl_Num)
		VALUES
		<foreach item="item" collection="list"  separator=", " >
					(#{item.dl_Image}, 
					)
		</foreach>
	</insert>
	
	<select id="selectMap" resultMap="dealResult">
		<![CDATA[
			SELECT *
			FROM dealing_t
		]]>
	</select>
	
	<select id="selectMap2" resultMap="dealResult" parameterType="java.util.Map">
			SELECT *
			FROM dealing_t
			WHERE
			1=1 
			<if test="dl_Form != null and dl_Form !=''">
			AND dl_Form LIKE CONCAT('%', #{dl_Form}, '%') 
			</if>
			<if test="dl_Form2 != null and dl_Form2 !=''">
			AND dl_Form2 = #{dl_Form2}   
			</if>
			<if test="dl_Room != null and dl_Room !=''">
			AND dl_Room LIKE CONCAT('%', #{dl_Room}, '%') 
			</if>
			<if test="dl_Option != null and dl_Option !=''"> 
			AND dl_Option LIKE CONCAT('%', #{dl_Option}, '%') 
			</if>
			<if test="dl_Price != null and dl_Price !=''">
			AND #{dl_Price} >= dl_Price 
			</if>
			<if test="dl_Address != null and dl_Address !=''">
			AND dl_Address LIKE CONCAT('%', #{dl_Address}, '%')
			</if>
	</select>
	

	<!--매물 전체검색 -->
	<select id = "allListdealing" resultType="dealingVO"  parameterType="dealingVO">
	<![CDATA[
			SELECT *
			FROM dealing_t
		]]>
	</select>	


	</mapper>